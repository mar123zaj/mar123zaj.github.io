---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { ArrowLeft, Github, ExternalLink } from "@lucide/astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { slug: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<BaseLayout title={project.data.title} description={project.data.description} image={project.data.image}>
  <article class="max-w-3xl mx-auto px-4 py-16">
    <header class="mb-10">
      <a href="/portfolio" class="inline-flex items-center gap-1 text-sm text-indigo-600 dark:text-indigo-400 hover:underline mb-6">
        <ArrowLeft size={16} />
        Back to portfolio
      </a>
      <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-4">{project.data.title}</h1>
      <p class="text-lg text-gray-600 dark:text-gray-400 mb-4">{project.data.description}</p>

      {project.data.tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mb-6">
          {project.data.tags.map((tag) => (
            <span class="px-2 py-1 text-xs font-medium rounded-md bg-indigo-50 dark:bg-indigo-950 text-indigo-600 dark:text-indigo-400">
              {tag}
            </span>
          ))}
        </div>
      )}

      <div class="flex items-center gap-4">
        {project.data.github && (
          <a href={project.data.github} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-900 dark:bg-white text-white dark:text-gray-900 text-sm font-medium hover:opacity-90 transition-opacity">
            <Github size={16} />
            View Source
          </a>
        )}
        {project.data.live && (
          <a href={project.data.live} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
            <ExternalLink size={16} />
            Live Demo
          </a>
        )}
      </div>
    </header>

    <div class="prose prose-gray dark:prose-invert prose-headings:tracking-tight prose-a:text-indigo-600 dark:prose-a:text-indigo-400 max-w-none">
      <Content />
    </div>
  </article>
</BaseLayout>
